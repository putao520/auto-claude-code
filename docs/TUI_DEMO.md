# Auto Claude Code TUI 监控界面

## 概述

Auto Claude Code 现在支持类似 Linux `top` 命令的 TUI（Terminal User Interface）实时监控界面，让您可以直观地查看和管理所有任务的执行状态。

## 功能特性

### 🎯 实时监控
- **自动刷新**：默认每2秒自动更新任务状态
- **实时数据**：显示任务的最新执行情况
- **系统概览**：总任务数、运行中、已完成、失败任务统计

### 🎨 直观界面
- **分区布局**：头部信息、系统概览、任务列表、任务详情、快捷键帮助
- **颜色标识**：不同状态用不同颜色区分
- **表格显示**：清晰的表格格式展示任务信息
- **选择高亮**：当前选中的任务会高亮显示

### ⌨️ 交互操作
- **键盘导航**：使用方向键选择任务
- **任务管理**：直接在界面中取消任务
- **手动刷新**：按 `r` 键立即刷新数据
- **响应式**：自动适应终端窗口大小变化

## 使用方法

### 启动TUI监控
```bash
# 使用默认设置启动
auto-claude-code task tui

# 指定刷新间隔（秒）
auto-claude-code task tui -i 5

# 指定MCP服务器地址
auto-claude-code task tui -s http://192.168.1.100:8080

# 组合使用
auto-claude-code task tui -s http://localhost:8080 -i 3
```

### 快捷键操作

| 快捷键 | 功能 |
|--------|------|
| `↑` / `↓` | 选择上一个/下一个任务 |
| `Enter` | 查看任务详情（预留功能） |
| `c` | 取消当前选中的任务 |
| `r` | 手动刷新数据 |
| `q` / `Ctrl+C` | 退出TUI界面 |

## 界面布局

```
┌─ Auto Claude Code - 任务监控 ──────────────────────────────────────────┐
│ Auto Claude Code 任务监控 | 服务器: http://localhost:8080 | 最后更新: 14:30:25 │
├─ 系统概览 ──────────────┬─ 任务详情 ─────────────────────────────────────┤
│ 总任务数: 5              │ ID: a1b2c3d4                                   │
│ 运行中: 2               │ 状态: running                                  │
│ 已完成: 2               │ 项目: /path/to/project                         │
│ 失败: 1                 │ 描述: 实现用户认证功能                          │
│ 运行时间: 2h15m         │ 优先级: high                                   │
│                         │ 创建时间: 2024-01-15 14:25:30                 │
│                         │ 开始时间: 14:26:15                             │
│                         │ 完成时间: -                                    │
├─ 任务列表 ──────────────────────────────────────────────────────────────┤
│ ID       │ 状态 │ 项目        │ 描述              │ 优先级 │ 创建时间 │ 耗时   │
│ a1b2c3d4 │ 🔄   │ my-project  │ 实现用户认证功能   │ high   │ 14:25:30 │ 4m15s  │
│ e5f6g7h8 │ ✅   │ web-app     │ 修复登录bug       │ medium │ 14:20:10 │ 3m45s  │
│ i9j0k1l2 │ ❌   │ api-server  │ 优化数据库查询     │ low    │ 14:15:00 │ 2m30s  │
├─ 快捷键 ────────────────────────────────────────────────────────────────┤
│ ↑/↓: 选择任务 | Enter: 查看详情 | c: 取消任务 | r: 刷新 | q: 退出        │
└─────────────────────────────────────────────────────────────────────────┘
```

## 状态图标说明

| 图标 | 状态 | 说明 |
|------|------|------|
| ⏳ | pending | 任务等待执行 |
| 🔄 | running | 任务正在执行 |
| ✅ | completed | 任务执行成功 |
| ❌ | failed | 任务执行失败 |
| 🚫 | cancelled | 任务已取消 |
| ⏰ | timeout | 任务执行超时 |

## 颜色方案

- **头部**：青色边框 - 显示基本信息
- **系统概览**：绿色边框 - 统计信息
- **任务列表**：黄色边框 - 主要内容区域
- **任务详情**：紫色边框 - 详细信息
- **快捷键**：白色边框 - 操作提示
- **选中行**：蓝色背景 - 当前选中的任务

## 自适应特性

- **窗口大小**：自动适应终端窗口大小变化
- **内容截断**：长文本自动截断并显示省略号
- **响应式布局**：根据窗口大小调整各区域比例

## 错误处理

- **网络错误**：连接失败时继续显示上次的数据
- **数据错误**：解析失败时保持界面稳定
- **优雅降级**：出现问题时不会崩溃，继续提供基本功能

## 性能优化

- **增量更新**：只更新变化的数据
- **智能刷新**：避免不必要的重绘
- **内存管理**：及时清理过期数据

## 使用场景

1. **开发调试**：实时监控任务执行状态
2. **性能分析**：观察任务执行时间和资源使用
3. **问题排查**：快速定位失败的任务
4. **批量管理**：同时监控多个项目的任务
5. **运维监控**：服务器端任务状态监控

## 与其他命令的对比

| 功能 | `task list` | `task watch` | `task tui` |
|------|-------------|--------------|------------|
| 显示方式 | 一次性输出 | 滚动输出 | 固定界面 |
| 交互性 | 无 | 无 | 完整交互 |
| 信息密度 | 中等 | 低 | 高 |
| 适用场景 | 快速查看 | 简单监控 | 深度监控 |
| 资源占用 | 最低 | 低 | 中等 |

## 技术实现

- **UI库**：基于 `github.com/gizak/termui/v3`
- **更新机制**：定时器 + 事件驱动
- **数据获取**：HTTP API 调用
- **错误恢复**：优雅的错误处理和重试机制
- **跨平台**：支持 Windows、Linux、macOS

## 未来计划

- [ ] 任务详情弹窗
- [ ] 日志实时查看
- [ ] 性能图表显示
- [ ] 自定义颜色主题
- [ ] 配置文件支持
- [ ] 插件系统

---

TUI监控界面为 Auto Claude Code 提供了强大的可视化任务管理能力，让您能够更直观、更高效地监控和管理所有的代码生成任务。 